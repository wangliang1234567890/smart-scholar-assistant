<!--pages/settings/settings.wxml-->
<view class="settings-container">
  <scroll-view class="settings-content" scroll-y enable-back-to-top>
    
    <!-- 学习设置 -->
    <view class="settings-section">
      <view class="section-header">
        <view class="section-icon">
          <text class="icon-text">⚙️</text>
        </view>
        <text class="section-title">学习设置</text>
      </view>
      
      <view class="settings-group">
        <!-- 学习提醒 -->
        <view class="setting-item">
          <view class="setting-left">
            <text class="setting-label">学习提醒</text>
            <text class="setting-desc">每日复习提醒时间</text>
          </view>
          <view class="setting-right">
            <van-switch 
              checked="{{userSettings.reminderEnabled}}" 
              bind:change="onToggleChange"
              data-key="reminderEnabled"
              active-color="#4F46E5"
              size="24"
            />
          </view>
        </view>
        
        <!-- 提醒时间 -->
        <view class="setting-item" wx:if="{{userSettings.reminderEnabled}}">
          <view class="setting-left">
            <text class="setting-label">提醒时间</text>
            <text class="setting-desc">每日复习提醒时间</text>
          </view>
          <view class="setting-right">
            <picker 
              mode="time" 
              value="{{userSettings.reminderTime}}" 
              bind:change="onTimeChange"
            >
              <view class="setting-value">{{userSettings.reminderTime}}</view>
            </picker>
          </view>
        </view>
        
        <!-- 复习间隔 -->
        <view class="setting-item">
          <view class="setting-left">
            <text class="setting-label">复习间隔</text>
            <text class="setting-desc">错题复习的间隔时间</text>
          </view>
          <view class="setting-right">
            <picker 
              range="{{settingOptions.reviewIntervals}}" 
              range-key="label"
              value="{{userSettings.reviewInterval}}"
              bind:change="onPickerChange"
              data-key="reviewInterval"
              data-options="reviewIntervals"
            >
              <view class="setting-value">{{reviewIntervalLabel}}</view>
            </picker>
          </view>
        </view>
        
        <!-- 练习模式 -->
        <view class="setting-item">
          <view class="setting-left">
            <text class="setting-label">练习模式</text>
            <text class="setting-desc">题目的出现顺序</text>
          </view>
          <view class="setting-right">
            <picker 
              range="{{settingOptions.practiceModes}}" 
              range-key="label"
              value="{{userSettings.practiceMode}}"
              bind:change="onPickerChange"
              data-key="practiceMode"
              data-options="practiceModes"
            >
              <view class="setting-value">{{practiceModeLabel}}</view>
            </picker>
          </view>
        </view>
        
        <!-- 难度等级 -->
        <view class="setting-item">
          <view class="setting-left">
            <text class="setting-label">难度等级</text>
            <text class="setting-desc">题目难度偏好</text>
          </view>
          <view class="setting-right">
            <picker 
              range="{{settingOptions.difficultyLevels}}" 
              range-key="label"
              value="{{userSettings.difficultyLevel}}"
              bind:change="onPickerChange"
              data-key="difficultyLevel"
              data-options="difficultyLevels"
            >
              <view class="setting-value">{{difficultyLevelLabel}}</view>
            </picker>
          </view>
        </view>
      </view>
    </view>

    <!-- 界面设置 -->
    <view class="settings-section">
      <view class="section-header">
        <view class="section-icon section-icon-purple">
          <text class="icon-text">👁️</text>
        </view>
        <text class="section-title">界面设置</text>
      </view>
      
      <view class="settings-group">
        <!-- 主题模式 -->
        <view class="setting-item">
          <view class="setting-left">
            <text class="setting-label">主题模式</text>
            <text class="setting-desc">选择应用主题</text>
          </view>
          <view class="setting-right">
            <picker 
              range="{{settingOptions.themes}}" 
              range-key="label"
              value="{{userSettings.theme}}"
              bind:change="onPickerChange"
              data-key="theme"
              data-options="themes"
            >
              <view class="setting-value">{{themeLabel}}</view>
            </picker>
          </view>
        </view>
        
        <!-- 字体大小 -->
        <view class="setting-item">
          <view class="setting-left">
            <text class="setting-label">字体大小</text>
            <text class="setting-desc">调整界面字体大小</text>
          </view>
          <view class="setting-right">
            <picker 
              range="{{settingOptions.fontSizes}}" 
              range-key="label"
              value="{{userSettings.fontSize}}"
              bind:change="onPickerChange"
              data-key="fontSize"
              data-options="fontSizes"
            >
              <view class="setting-value">{{fontSizeLabel}}</view>
            </picker>
          </view>
        </view>
        
        <!-- 音效设置 -->
        <view class="setting-item">
          <view class="setting-left">
            <text class="setting-label">音效设置</text>
            <text class="setting-desc">按键音、提示音</text>
          </view>
          <view class="setting-right">
            <van-switch 
              checked="{{userSettings.soundEnabled}}" 
              bind:change="onToggleChange"
              data-key="soundEnabled"
              active-color="#4F46E5"
              size="24"
            />
          </view>
        </view>
        
        <!-- 震动反馈 -->
        <view class="setting-item">
          <view class="setting-left">
            <text class="setting-label">震动反馈</text>
            <text class="setting-desc">触摸震动反馈</text>
          </view>
          <view class="setting-right">
            <van-switch 
              checked="{{userSettings.vibrationEnabled}}" 
              bind:change="onToggleChange"
              data-key="vibrationEnabled"
              active-color="#4F46E5"
              size="24"
            />
          </view>
        </view>
      </view>
    </view>

    <!-- 数据管理 -->
    <view class="settings-section">
      <view class="section-header">
        <view class="section-icon section-icon-green">
          <text class="icon-text">📊</text>
        </view>
        <text class="section-title">数据管理</text>
      </view>
      
      <view class="settings-group">
        <!-- 自动备份 -->
        <view class="setting-item">
          <view class="setting-left">
            <text class="setting-label">自动备份</text>
            <text class="setting-desc">学习数据云端同步</text>
          </view>
          <view class="setting-right">
            <van-switch 
              checked="{{userSettings.autoSync}}" 
              bind:change="onToggleChange"
              data-key="autoSync"
              active-color="#4F46E5"
              size="24"
            />
          </view>
        </view>
        
        <!-- 缓存清理 -->
        <view class="setting-item">
          <view class="setting-left">
            <text class="setting-label">缓存清理</text>
            <text class="setting-desc">当前缓存: {{cacheSize}}</text>
          </view>
          <view class="setting-right">
            <view class="clear-btn" bind:tap="onClearCache">清理</view>
          </view>
        </view>
      </view>
    </view>

    <!-- 关于应用 -->
    <view class="settings-section">
      <view class="section-header">
        <view class="section-icon section-icon-orange">
          <text class="icon-text">ℹ️</text>
        </view>
        <text class="section-title">关于应用</text>
      </view>
    </view>

    <!-- 应用信息 -->
    <view class="app-info">
      <view class="app-logo">
        <text class="logo-text">🧠</text>
      </view>
      <view class="app-name">智能学霸小助手</view>
      <view class="app-version">版本 1.0.0</view>
      <view class="app-copyright">© 2025 智能学习科技有限公司</view>
    </view>

  </scroll-view>
</view>

<!-- 弹出层 -->
<van-popup show="{{showTimePicker}}" position="bottom" bind:close="hideTimePicker">
  <van-datetime-picker 
    type="time" 
    value="{{currentTime}}" 
    bind:confirm="confirmTime"
    bind:cancel="hideTimePicker"
    title="设置提醒时间"
  />
</van-popup> 