<!--pages/schedule/detail.wxml-->
<view class="detail-container">
  <block wx:if="{{isLoading}}">
    <view class="loading-wrapper">
      <van-loading type="spinner" size="32px">åŠ è½½ä¸­...</van-loading>
    </view>
  </block>
  <block wx:elif="{{!course}}">
    <van-empty description="è¯¾ç¨‹ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤" />
  </block>
  <block wx:else>
    <!-- è¯¾ç¨‹æ ‡é¢˜æ  -->
    <view class="course-title-bar">
      <view class="back-button" bind:tap="goBack">
        <van-icon name="arrow-left" size="20" color="#333" />
      </view>
      <text class="page-title">è¯¾ç¨‹è¯¦æƒ…</text>
      <view class="more-actions">
        <van-icon name="ellipsis" size="20" color="#333" />
      </view>
    </view>

    <!-- è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
    <view class="course-info-card">
      <view class="course-header-info">
        <view class="course-subject-icon {{course.subject}}">
          <text class="subject-text">{{course.subjectShort}}</text>
        </view>
        <view class="course-basic-info">
          <view class="course-title">{{course.name}}</view>
          <view class="course-subtitle">{{course.subject}} Â· {{course.teacher}}</view>
        </view>
      </view>
    </view>

    <!-- è¯¾ç¨‹ç»Ÿè®¡æ•°æ® -->
    <view class="course-statistics">
      <view class="stat-box">
        <text class="stat-number">{{course.completedLessons}}</text>
        <text class="stat-label">å·²ä¸Šè¯¾æ¬¡</text>
      </view>
      <view class="stat-box">
        <text class="stat-number">{{course.totalLessons}}</text>
        <text class="stat-label">æ€»è¯¾æ—¶</text>
      </view>
      <view class="stat-box">
        <text class="stat-number">{{course.completionRate}}%</text>
        <text class="stat-label">å®Œæˆè¿›åº¦</text>
      </view>
    </view>

    <!-- è¯¾ç¨‹çŠ¶æ€ -->
    <view class="course-status-section">
      <view class="status-indicator {{course.status}}">{{course.statusText}}</view>
    </view>

    <!-- è¯¾ç¨‹ä¿¡æ¯è¯¦ç»† -->
    <view class="course-details-section">
      <view class="section-header">è¯¾ç¨‹ä¿¡æ¯</view>
      <view class="detail-items">
        <view class="detail-item">
          <view class="detail-icon calendar-icon">
            <van-icon name="calendar-o" size="16" color="#fff" />
          </view>
          <view class="detail-content">
            <text class="detail-label">ä¸Šè¯¾æ—¶é—´</text>
            <text class="detail-value">{{course.scheduleTime}}</text>
          </view>
        </view>
        <view class="detail-item">
          <view class="detail-icon time-icon">
            <van-icon name="clock-o" size="16" color="#fff" />
          </view>
          <view class="detail-content">
            <text class="detail-label">è¯¾ç¨‹æ—¶é•¿</text>
            <text class="detail-value">{{course.duration}} åˆ†é’Ÿ</text>
          </view>
        </view>
        <view class="detail-item">
          <view class="detail-icon location-icon">
            <van-icon name="location-o" size="16" color="#fff" />
          </view>
          <view class="detail-content">
            <text class="detail-label">ä¸Šè¯¾åœ°ç‚¹</text>
            <text class="detail-value">{{course.location}}</text>
          </view>
        </view>
        <view class="detail-item">
          <view class="detail-icon teacher-icon">
            <van-icon name="manager-o" size="16" color="#fff" />
          </view>
          <view class="detail-content">
            <text class="detail-label">ä»»è¯¾è€å¸ˆ</text>
            <text class="detail-value">{{course.teacher}}</text>
          </view>
        </view>
        <view class="detail-item">
          <view class="detail-icon type-icon">
            <van-icon name="label-o" size="16" color="#fff" />
          </view>
          <view class="detail-content">
            <text class="detail-label">è¯¾ç¨‹ç±»å‹</text>
            <text class="detail-value">{{course.courseType}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- è¯¾ç¨‹æè¿° -->
    <view class="course-description-section">
      <view class="section-header">è¯¾ç¨‹æè¿°</view>
      <text class="description-text">{{course.description}}</text>
    </view>

    <!-- è¯¾åä½œä¸š -->
    <view class="homework-section">
      <view class="section-header">è¯¾åä½œä¸š</view>
      <view class="homework-items">
        <view wx:for="{{course.homework}}" wx:key="id" class="homework-task" bind:tap="toggleHomework" data-id="{{item.id}}">
          <view class="homework-checkbox">
            <van-icon name="{{item.completed ? 'success' : 'circle'}}" 
                      size="16" 
                      color="{{item.completed ? '#52c41a' : '#d9d9d9'}}" />
          </view>
          <text class="homework-text {{item.completed ? 'completed' : ''}}">{{item.title}}</text>
        </view>
      </view>
    </view>

    <!-- æ‰€éœ€ææ–™ -->
    <view class="materials-section">
      <view class="section-header">æ‰€éœ€ææ–™</view>
      <view class="materials-grid">
        <view wx:for="{{course.materials}}" wx:key="type" class="material-card">
          <view class="material-icon-wrapper">
            <image wx:if="{{item.icon}}" src="{{item.icon}}" class="material-icon" />
            <view wx:else class="material-default-icon">ğŸ“–</view>
          </view>
          <text class="material-name">{{item.name}}</text>
          <text class="material-category">{{item.type}}</text>
        </view>
      </view>
    </view>

    <!-- æé†’è®¾ç½® */
    <view class="reminder-settings-section">
      <view class="section-header">æé†’è®¾ç½®</view>
      <view class="reminder-option">
        <view class="reminder-info">
          <view class="reminder-icon-wrapper">
            <van-icon name="bell" size="20" color="#faad14" />
          </view>
          <view class="reminder-text-info">
            <text class="reminder-title">è¯¾å‰æé†’</text>
            <text class="reminder-desc">ä¸Šè¯¾å‰15åˆ†é’Ÿæé†’</text>
          </view>
        </view>
        <van-switch checked="{{course.reminderEnabled}}" bind:change="onReminderToggle" />
      </view>
    </view>

    <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
    <view class="bottom-actions">
      <van-button class="action-button edit-button" bind:tap="handleEdit">
        <van-icon name="edit" size="16" />
        ç¼–è¾‘è¯¾ç¨‹
      </van-button>
      <van-button class="action-button delete-button" plain bind:tap="handleDelete">
        <van-icon name="delete-o" size="16" />
        åˆ é™¤è¯¾ç¨‹
      </van-button>
    </view>
  </block>
</view> 